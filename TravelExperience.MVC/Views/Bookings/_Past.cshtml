@model TravelExperience.MVC.ViewModels.MainPageViewModel
@using Microsoft.AspNet.Identity
@*@model IEnumerable<TravelExperience.DataAccess.Core.Entities.Booking>*@

<h2 style="color:darkred;">Where you've been</h2>

<div class="container" style="padding: 3px; overflow:hidden;">
    @foreach (var item in Model.Bookings)
    {
        var userID = User.Identity.GetUserId();
        if (HttpContext.Current.User.Identity.IsAuthenticated && userID == item.UserId)
        {
            if (item.BookingStartDate <= DateTime.Now)
            {
                var startDate = item.BookingStartDate.ToString("d MMM yyyy");
                var endDate = item.BookingEndDate.ToString("d MMM yyyy");
                <div class="col-md-5">
                    <div style="float:right;margin-left: 15px; display: inline-block; margin: 2px 40px 0 0; white-space:pre-line; ">
                        <strong>@Html.DisplayFor(modelItem => item.Accommodation.Title) - @Html.DisplayFor(modelItem => item.Accommodation.Location.City) </strong>
                        @Html.DisplayFor(modelItem => startDate) - @Html.DisplayFor(modelItem => endDate)
                        @Html.ActionLink("Details", "Details", new { id = item.BookingID })
                    </div>
                    @*<img src="@Url.Content(item.Accommodation.Thumbnail)" style="margin-right: 10px; float: left; border: 1px solid #ddd; border-radius: 4px; padding: 5px; width: 150px;" />*@

                    @*Loads the given thumbnailAccommodation ImageInfo. Then it loads as a partial view the aquired image.*@
                    @{ var firstThumb = @Model.ThumbnailOfAccommodations[item.Accommodation].FirstOrDefault(); }
                    @Html.Partial("_AccommodationThumbnail", @firstThumb)
                </div>
            }
        }
    }
</div>
